let roundabout={on:-1,usedIds:[],overwritten:"no",defaults:{pages:[],breakpoints:[{width:300,height:0,swipeThreshold:50}],listenForResize:!1,interpolate:[],id:".myCarousel",parent:"body",lazyLoad:"none",uiEnabled:!0,rotation:"none",type:"slider",infinite:!0,keys:!0,buttons:!0,swipe:!0,swipeThreshold:300,swipeMultiplier:1,swipeResistance:.95,swipeSnap:!0,swipeSpeed:1200,pagesToShow:1,pageSpacing:0,pageSpacingUnits:"px",pageSpacingMode:"fill",scrollBy:1,showWrappedPage:!1,transition:300,transitionFunction:"ease",navigation:!0,navigationTrim:!0,navigationBehavior:"nearest",autoscroll:!1,autoscrollSpeed:5e3,autoscrollTimeout:15e3,autoscrollPauseOnHover:!1,autoscrollStartAfter:5e3,autoscrollDirection:"right",throttle:!0,throttleTimeout:300,throttleKeys:!0,throttleSwipe:!0,throttleButtons:!0,throttleNavigation:!0,nextHTML:'<svg viewBox="0 0 24 24"><path fill="currentColor" d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>',prevHTML:'<svg viewBox="0 0 24 24"><path fill="currentColor" d="M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z" /></svg>',initOnly:!1}};class Roundabout{constructor(settings=roundabout.defaults){roundabout.overwritten&&"no"==roundabout.overwritten||console.error('Do not redefine the variable "roundabout". Roundabout requires this variable to store data across multiple carousels.');let s=Object.entries(settings),d=Object.entries(roundabout.defaults);this.VERSION="1.4.0-DEV",console.log(`Using version ${this.VERSION}`);for(let a=0;a<d.length;a++){let f=!1;for(let b=0;b<s.length;b++){if(!roundabout.defaults.hasOwnProperty(s[b][0]))throw`Error: Invalid Roundabout setting: "${s[b][0]}"`;if(s[b][0].toString()==d[a][0].toString()){this[s[b][0].toString()]=s[b][1],f=!0;break}}!f&&roundabout.defaults.hasOwnProperty(d[a][0])&&(this[d[a][0].toString()]=d[a][1])}if(this._orderedPages=[],this._positions=[],this._orderedPagesMainIndex=0,this._scrollIsAllowed=!0,this.onPage=0,this._handledLoad=!1,this._loadQueue=[],this._loadingPages=!1,this._uniqueId=roundabout.on+1,this._overriddenValues=[],this._currentBp=-2,this._atEnd=!0,this.activeBreakpoint=null,this._calculatedPageSize=null,this._allowInternalStyles=!0,this._allowInternalHTML=!0,this._sx=0,this._ex=0,this._dx=0,this._x=0,this._lastDx=0,this._lastMove=null,this._t=!1,this._dragging=!1,this._canSnap=!1,this._swipeFrom=0,this._swipeIsAllowed=!0,this._sts=0,this._ste=0,this._distPercent=0,this._scrollTimeoutHolder=null,this._scrollIntervalHolder=null,this._scrollAfterTimeoutHolder=null,this._boundFollow=null,this._boundEnd=null,this._boundCancel=null,this._callbacks={scroll:[],scrollEnd:[],dragStart:[],dragEnd:[],scrollNext:[],scrollPrevious:[],scrollNextEnd:[],scrollPreviousEnd:[],load:[],beforeDestroy:[],afterDestroy:[]},!this.initOnly&&this.initialActions()){try{this.setListeners()}catch(e){console.error(`Error while attempting to add event listeners to Roundabout with id ${this.id}:`),console.error(e)}try{this.setBreakpoints()}catch(e){console.error(`Error while attempting to set breakpoint values in Roundabout with id ${this.id}:`),console.error(e)}}}scroll(distance,valuesOnly,overflow=0){if(this._callbacks.scroll.forEach(cb=>{cb()}),!(distance>0&&this._onPage>=this.pages.length-this.pagesToShow&&!this.infinite&&"slider"==this.type||distance<0&&this._onPage<=0&&!this.infinite&&"slider"==this.type))if(distance>0&&distance>this.pages.length-this.pagesToShow-this.onPage&&!this.infinite){let remainingDistance=this.pages.length-this.pagesToShow-this.onPage;this.scroll(remainingDistance,valuesOnly,distance-remainingDistance)}else if(distance<0&&Math.abs(distance)>this.onPage&&!this.infinite){let remainingDistance=-1*this.onPage;this.scroll(remainingDistance,valuesOnly)}else{let wrapper=document.querySelector(`.roundabout-${this._uniqueId}-page-wrap`),pos=[];if(distance>0){for(let a=0;a<this._positions.length;a++)pos.push(a);this._callbacks.scrollNext.forEach(cb=>{cb()})}else if(distance<0){if("slider"==this.type)for(let a=0;a<this._positions.length;a++)pos.push(a-Math.abs(distance)-1);else if("gallery"==this.type)for(let a=0;a<this._positions.length;a++)a<2*this.pagesToShow?pos.push(a%this.pagesToShow):pos.push(a);this._callbacks.scrollPrevious.forEach(cb=>{cb()})}if(distance<0){let z="slider"==this.type?1:0;for(let a=0;a<Math.abs(distance)+z;a++)pos.push(pos.shift())}for(let a=0;a<this._positions.length;a++){let beforeMove="slider"==this.type?this.calcPagePos(pos[a]):this.calcPagePos(pos[a],{direction:distance});"0px"!=beforeMove&&document.querySelector(`.roundabout-${this._uniqueId}-page-${this._orderedPages[a]}`).classList.remove(`roundabout-${this._uniqueId}-hidden-page`),"gallery"==this.type&&(a<this.pagesToShow?document.querySelector(`.roundabout-${this._uniqueId}-page-${this._orderedPages[a]}`).classList.add("roundabout-fadeout"):document.querySelector(`.roundabout-${this._uniqueId}-page-${this._orderedPages[a]}`).classList.remove("roundabout-fadeout")),document.querySelector(`.roundabout-${this._uniqueId}-page-${this._orderedPages[a]}`).style.left=beforeMove}this.navigationTrim&&(overflow=0),valuesOnly||"slider"!=this.type||(wrapper.style.left=this.calcPagePos(-distance,{wrap:!0}));for(let a=0;a<Math.abs(distance);a++)distance>0?(this._positions.unshift(this._positions.pop()),this._orderedPages.push(this._orderedPages.shift())):distance<0&&(this._positions.push(this._positions.shift()),this._orderedPages.unshift(this._orderedPages.pop()));for(let a=0;a<this.pagesToShow;a++)document.querySelector(`.roundabout-${this._uniqueId}-visible-page-${a}`).classList.remove(`roundabout-${this._uniqueId}-visible-page-${a}`),document.querySelector(`.roundabout-${this._uniqueId}-page-${this._orderedPages[a]}`).classList.add(`roundabout-${this._uniqueId}-visible-page-${a}`);this.onPage+=distance,this._lastDx=0,distance>0&&this.onPage>=this.pages.length?this.onPage-=this.pages.length:distance<0&&this.onPage<0&&(this.onPage+=this.pages.length),valuesOnly?(this.positionWrap(!valuesOnly),this.positionPages()):setTimeout(()=>{"slider"==this.type&&this.positionWrap(!valuesOnly),this.positionPages(),this._callbacks.scrollEnd.forEach(cb=>{cb()}),distance>0?this._callbacks.scrollNextEnd.forEach(cb=>{cb()}):distance<0&&this._callbacks.scrollPreviousEnd.forEach(cb=>{cb()})},this.transition),this.navigation&&this.setActiveBtn("slider"==this.type?this.onPage+overflow:Math.floor(this.onPage/this.pagesToShow)%Math.floor(this.pages.length/this.pagesToShow)),"hidden"==this.lazyLoad&&(distance>0?this.load(this._orderedPages.slice(this.pagesToShow,this.pagesToShow+this.scrollBy)):distance<0&&this.load(this._orderedPages.slice(this._orderedPages.length-this.scrollBy,this._orderedPages.length)))}}scrollTo(page,transition=!0){if(this._scrollIsAllowed&&this.throttleNavigation&&this.navigation?this.setActiveBtn("slider"==this.type?this.onPage:Math.floor(this.onPage/this.pagesToShow)%Math.floor(this.pages.length/this.pagesToShow)):!this.throttleNavigation&&this.navigation&&this.setActiveBtn("slider"==this.type?this.onPage:Math.floor(this.onPage/this.pagesToShow)%Math.floor(this.pages.length/this.pagesToShow)),"hidden"==this.lazyLoad){let toLoad=[];for(let a=-this.scrollBy;a<this.pagesToShow+this.scrollBy;a++){let idx=(a+page)%this._orderedPages.length;idx<0&&(idx+=this._orderedPages.length),toLoad.push(this._orderedPages[idx])}this.load(toLoad)}this.infinite&&"direction"!=this.navigationBehavior?this.findOffset(this.onPage,page,"p")<this.findOffset(this.onPage,page,"n")?this.throttleNavigation?this.scrollHandler(this,"scrollto",-1*this.findOffset(this.onPage,page,"p"),transition):this.scroll(-1*this.findOffset(this.onPage,page,"p"),transition):this.throttleNavigation?this.scrollHandler(this,"scrollto",this.findOffset(this.onPage,page,"n")):this.scroll(this.findOffset(this.onPage,page,"n"),transition):this.throttleNavigation?this.scrollHandler(this,"scrollto",page-this.onPage):this.scroll(page-this.onPage,transition)}setActiveBtn(id){document.querySelector(`.roundabout-${this._uniqueId}-active-nav-btn`).classList.add(`roundabout-${this._uniqueId}-inactive-nav-btn`,"roundabout-inactive-nav-btn"),document.querySelector(`.roundabout-${this._uniqueId}-active-nav-btn`).classList.remove(`roundabout-${this._uniqueId}-active-nav-btn`,"roundabout-active-nav-btn"),document.querySelector(`.roundabout-${this._uniqueId}-nav-btn-${id}`).classList.add(`roundabout-${this._uniqueId}-active-nav-btn`,"roundabout-active-nav-btn"),document.querySelector(`.roundabout-${this._uniqueId}-nav-btn-${id}`).classList.remove(`roundabout-${this._uniqueId}-inactive-nav-btn`,"roundabout-inactive-nav-btn")}scrollHandler(parent,from,distance,transition=!0){let sd;"snap"==from?distance>0?sd=1:distance<0&&(sd=-1):"scrollto"==from?sd=distance:distance>0?sd=parent.scrollBy:distance<0&&(sd=-parent.scrollBy),parent.resetScrollTimeout(),parent._scrollIsAllowed&&!parent._dragging&&(parent.scroll(sd,!1,transition),(parent.throttle&&parent.throttleButtons&&"key"!=from||parent.throttle&&parent.throttleKeys&&"key"==from)&&(parent._scrollIsAllowed=!1,setTimeout(()=>{parent._scrollIsAllowed=!0},parent.throttleTimeout)))}resetScrollTimeout(f=!1){clearTimeout(this._scrollTimeoutHolder),clearInterval(this._scrollIntervalHolder),this._scrollTimeoutHolder=setTimeout(()=>{f&&this.scrollAuto(this),this.setAutoScroll(this)},this.autoscrollTimeout)}setAutoScroll(parent,firstTime=!1){firstTime&&parent.autoscroll?parent._scrollAfterTimeoutHolder=setTimeout(()=>{parent.scrollAuto(parent),parent._scrollIntervalHolder=setInterval(()=>{parent.scrollAuto(parent)},parent.autoscrollSpeed)},parent.autoscrollStartAfter):parent.autoscroll&&(parent._scrollIntervalHolder=setInterval(()=>{parent.scrollAuto(parent)},parent.autoscrollSpeed))}scrollAuto(parent){"left"==parent.autoscrollDirection.toLowerCase()&&parent._scrollIsAllowed?parent.scroll(-this.scrollBy):"right"==parent.autoscrollDirection.toLowerCase()&&parent._scrollIsAllowed&&parent.scroll(this.scrollBy)}setTouch(event,parent){event.preventDefault(),parent._t=!0,parent.tStart(event,parent)}tStart(event,parent){if(this._callbacks.dragStart.forEach(cb=>{cb()}),parent.resetScrollTimeout(),parent.throttleSwipe){if(!parent._swipeIsAllowed)return;parent.throttle&&(parent._swipeIsAllowed=!1)}parent.swipeSpeed>0&&(parent._sts=Date.now()),event.preventDefault(),parent._dragging=!0,parent._swipeFrom=parent._orderedPages[parent._orderedPagesMainIndex],document.querySelector(`.roundabout-${parent._uniqueId}-page-wrap`).classList.remove(`roundabout-${this._uniqueId}-has-transition`),document.querySelector(`.roundabout-${parent._uniqueId}-page-wrap`).classList.add("roundabout-has-no-transition"),parent._lastMove=event.touches,parent._t?("none"==parent.rotation?parent._sx=event.touches[0].clientX:parent._sx=parent.rotation*event.touches[0].clientY,"none"==parent.rotation?parent._x=event.touches[0].clientX:parent._x=parent.rotation*event.touches[0].clientY):("none"==parent.rotation?parent._x=event.clientX:parent._x=parent.rotation*event.clientY,"none"==parent.rotation?parent._sx=event.clientX:parent._sx=parent.rotation*event.clientY),document.addEventListener("mousemove",parent._boundFollow,!1),document.addEventListener("mouseup",parent._boundEnd,!1),parent._t&&(document.addEventListener("touchmove",parent._boundFollow,!1),document.addEventListener("touchend",parent._boundEnd,!1),document.addEventListener("touchcancel",parent._boundCancel,!1))}follow(event,parent){if(parent._dragging){parent._t?"none"==parent.rotation?parent._x=event.changedTouches[0].clientX:parent._x=parent.rotation*event.changedTouches[0].clientY:"none"==parent.rotation?parent._x=event.clientX:parent._x=parent.rotation*event.clientY,parent._dx=(parent._x-parent._sx)*parent.swipeMultiplier,!parent.infinite&&(parent.onPage==parent.pages.length-parent.pagesToShow&&parent._dx<-1*parent._lastDx||0==parent.onPage&&parent._dx>-1*parent._lastDx)?parent._atEnd=!0:parent._atEnd=!1,Math.abs(parent._dx)<document.querySelector(parent.parent).offsetWidth&&parent.infinite?parent._dx=(parent._x-parent._sx)*parent.swipeMultiplier:parent._dx<0?parent.infinite?parent._dx-=(parent._dx+document.querySelector(parent.parent).offsetWidth)*parent.swipeResistance:parent.pages.length-parent.pagesToShow==parent.onPage&&(1==parent.swipeResistance?parent._dx=0:parent._atEnd&&(parent._dx-=(parent._dx+parent._lastDx)*parent.swipeResistance)):parent._dx>0&&(parent.infinite?parent._dx-=(parent._dx-document.querySelector(parent.parent).offsetWidth)*parent.swipeResistance:0===parent._orderedPages[parent._orderedPagesMainInd_ex]&&(1==parent.swipeResistance?parent._dx=0:parent._atEnd&&(parent._dx-=(parent._dx+parent._lastDx)*parent.swipeResistance))),parent._dx+=parent._lastDx;let dist=Math.abs(parent._dx);parent.checkCanSnap(parent),parent._distPercent=dist/parent._calculatedPageSize,0!=parent._distPercent&&parent.interpolate.forEach(inter=>{if(parent._dx>0){document.querySelector(`.roundabout-${parent._uniqueId}-visible-page-${inter.between[0][0]}`).style.transition=inter.value+" 0s";let val=(inter.between[1][1]-inter.between[0][1])*parent._distPercent+inter.between[0][1],re=inter.unit.replace("$",val);document.querySelector(`.roundabout-${parent._uniqueId}-visible-page-${inter.between[0][0]}`).style[inter.value]=re}else if(parent._dx<0){document.querySelector(`.roundabout-${parent._uniqueId}-visible-page-${inter.between[1][0]}`).style.transition=inter.value+" 0s";let val=(inter.between[0][1]-inter.between[1][1])*parent._distPercent+inter.between[1][1],re=inter.unit.replace("$",val);document.querySelector(`.roundabout-${parent._uniqueId}-visible-page-${inter.between[1][0]}`).style[inter.value]=re}});let totalSize=document.querySelector(`.roundabout-${parent._uniqueId}-page-`+parent._orderedPages[parent._orderedPagesMainIndex]).offsetWidth+parent.pageSpacing;dist>=totalSize&&parent.infinite||dist>=totalSize&&!parent.infinite&&(parent.onPage<parent.pages.length-parent.pagesToShow||parent.onPage==parent.pages.length-parent.pagesToShow&&parent._dx>0)&&(parent.onPage>0||0==parent.onPage&&parent._dx<0)?(parent._dx>0?parent.scroll("slider"==parent.type?-1:-parent.scrollBy,"slider"==parent.type):parent._dx<0&&parent.scroll("slider"==parent.type?1:parent.scrollBy,"slider"==parent.type),parent._sx=1*parent._x,parent._dx=0,parent._lastDx=0):"slider"==parent.type&&(document.querySelector(`.roundabout-${parent._uniqueId}-page-wrap`).style.left=parent._dx+"px")}}checkCanSnap(parent,checkSpeed=!1){let dist=Math.abs(parent._dx);parent.swipeSnap?dist>=parent.swipeThreshold&&parent.infinite||checkSpeed&&parent.infinite||(dist>=parent.swipeThreshold||checkSpeed)&&!parent.infinite&&(parent.onPage<parent.pages.length-parent.pagesToShow||parent.onPage==parent.pages.length-parent.pagesToShow&&parent._dx>0)&&(parent.onPage>0||0==parent.onPage&&parent._dx<0)?checkSpeed&&Math.abs((parent._ex-parent._sx)/(parent._ste-parent._sts)*1e3)>parent.swipeSpeed?parent._canSnap=!0:checkSpeed?parent._canSnap=!1:checkSpeed||(parent._canSnap=!0):parent._canSnap=!1:!parent.infinite&&(parent.onPage==parent.pages.length-parent.pagesToShow&&parent._dx<0||0==parent.onPage&&parent._dx>0)?parent._canSnap=!1:parent._canSnap=!0}tEnd(event,parent){if(parent._callbacks.dragEnd.forEach(cb=>{cb()}),setTimeout(()=>{parent._swipeIsAllowed=!0},parent.throttleTimeout),parent.interpolate)for(let a=0;a<parent.pagesToShow;a++){let t="";parent.interpolate.forEach(inter=>{t.includes(inter.value)||(t+=inter.value+" "+parent.transition/1e3+"s, "),document.querySelector(`.roundabout-${parent._uniqueId}-visible-page-${a}`).style[inter.value]=""}),t=t.substr(0,t.length-2)+";",document.querySelector(`.roundabout-${parent._uniqueId}-visible-page-${a}`).style.transition="",document.querySelector(`.roundabout-${parent._uniqueId}-visible-page-${a}`).style.transition=t}parent._distPercent=0,document.querySelector(`.roundabout-${parent._uniqueId}-page-wrap`).classList.add(`roundabout-${parent._uniqueId}-has-transition`),document.querySelector(`.roundabout-${parent._uniqueId}-page-wrap`).classList.remove("roundabout-has-no-transition"),parent._dragging=!1,parent._t?"none"==parent.rotation?parent._ex=event.changedTouches[0].clientX:parent._ex=parent.rotation*event.changedTouches[0].clientY:"none"==parent.rotation?parent._ex=event.clientX:parent._ex=parent.rotation*event.clientY,parent.swipeSnap||(parent._lastDx=1*parent._dx),parent.swipeSpeed>0&&Math.abs(parent._dx)<parent.swipeThreshold&&(parent._ste=Date.now(),parent.checkCanSnap(parent,!0));let tempSwipeSpeed=Math.abs((parent._ex-parent._sx)/(parent._ste-parent._sts)*1e3);(parent.swipeSnap||!parent.swipeSnap&&!parent._canSnap&&parent._atEnd)&&(parent.snap(parent._canSnap,parent._dx,parent),parent.swipeSnap||(parent._lastDx=0)),parent.resetSwipeVars(parent),document.removeEventListener("mousemove",parent._boundFollow,!1),document.removeEventListener("mouseup",parent._boundEnd,!1),document.removeEventListener("touchmove",parent._boundFollow,!1),document.removeEventListener("touchend",parent._boundEnd,!1),document.removeEventListener("touchcancel",parent._boundCancel,!1)}tCancel(event,parent){this._callbacks.dragEnd.forEach(cb=>{cb()}),parent._distPercent=0,event.preventDefault(),document.removeEventListener("mouseup",event=>{parent.tEnd(event,parent)},!1),document.removeEventListener("touchend",event=>{parent.tEnd(event,parent)},!1),document.removeEventListener("touchcancel",event=>{parent.tCancel(event,parent)},!1)}snap(al,dir,parent){al?dir>0?("slider"==parent.type&&parent.positionWrap(!1,1),parent.scrollHandler(parent,"snap","slider"==parent.type?-1:-parent.scrollBy)):dir<0&&("slider"==parent.type&&parent.positionWrap(!1,-1),parent.scrollHandler(parent,"snap","slider"==parent.type?1:parent.scrollBy)):"slider"==parent.type&&parent.positionWrap(!1,0)}resetSwipeVars(parent){parent.swipeSnap&&(parent._sx=0,parent._ex=0,parent._x=0,parent._dx=0),parent._lastMove=[],parent._t=!1,parent._canSnap=!1}_execMM(event){this.follow(event,this)}_execMU(event){this.tEnd(event,this)}_execTC(event){this.tCancel(event,this)}defaultHTML(r){let newCarousel=document.createElement("DIV"),ui="",swipe="",buttons="";this.buttons&&(buttons=`<div class="roundabout-${this._uniqueId}-btn-next roundabout-btn-next roundabout-scroll-btn">${this.nextHTML}</div><div class="roundabout-${this._uniqueId}-btn-prev roundabout-btn-prev roundabout-scroll-btn">${this.prevHTML}</div>`),this.uiEnabled&&(ui=`<div class="roundabout-${this._uniqueId}-ui roundabout-ui">${buttons}</div>`),this.swipe&&(swipe=`<div class="roundabout-${this._uniqueId}-swipe-overlay roundabout-swipe-overlay"></div>`);let html=`${swipe}<div class="roundabout-${this._uniqueId}-page-wrap roundabout-page-wrap roundabout-${this._uniqueId}-has-transition"></div>${ui}`;if(r)newCarousel=document.querySelector(this.id),newCarousel.innerHTML=html;else{if(newCarousel.innerHTML=html,newCarousel.classList.add("roundabout-wrapper"),"#"==this.id.split("")[0]){let newId=this.id.split("");newId.shift(),newId=newId.join(""),newCarousel.setAttribute("id",newId)}else{let newClass=this.id.split("");newClass.shift(),newClass=newClass.join(""),newCarousel.classList.add(newClass)}document.querySelector(this.parent).appendChild(newCarousel),document.querySelector(this.id).style.position="relative",document.querySelector(this.id).style.overflow="hidden"}document.querySelector(`.roundabout-${this._uniqueId}-page-wrap`).style.height="100%",document.querySelector(`.roundabout-${this._uniqueId}-page-wrap`).style.width="100%",document.querySelector(`.roundabout-${this._uniqueId}-page-wrap`).style.position="absolute",document.querySelector(`.roundabout-${this._uniqueId}-page-wrap`).style.left="0"}internalCSS(){let css=`.roundabout-${this._uniqueId}-has-transition {transition:${this.transition/1e3}s;transition-timing-function:${this.transitionFunction}}.roundabout-has-no-transition{transition: left 0s; !important}.roundabout-error-message {position:relative;margin:auto;left:0;right:0;top:0;bottom:0;border-radius:5px;border:3px solid black;background: white;text-align:center;font-family:sans-serif;width:30%;}`;if("gallery"==this.type){css+=`.roundabout-${this._uniqueId}-hidden-page {opacity: 0; z-index: 0; visibility: hidden;} .roundabout-fadeout {opacity: 0}`;for(let a=0;a<this.pagesToShow;a++)css+=`.roundabout-${this._uniqueId}-page-wrap .roundabout-${this._uniqueId}-visible-page-${a} {z-index: 1}`}else"slider"==this.type&&(css+=`.roundabout-${this._uniqueId}-hidden-page {visibility: hidden;}`);let newStyle=document.createElement("STYLE");newStyle.setAttribute("type","text/css"),newStyle.innerHTML=css,document.getElementsByTagName("head")[0].appendChild(newStyle)}generatePages(){let pagesCss="";for(let a=0;a<this.pages.length;a++){let newPage=document.createElement("DIV"),newPos,iteratorMod,iteratorMod2;newPage.classList.add(`roundabout-${this._uniqueId}-page-${a}`,"roundabout-page",`roundabout-${this._uniqueId}-page`),"evenly"==this.pageSpacingMode?(iteratorMod=1,iteratorMod2=0):(iteratorMod=-1,iteratorMod2=-1);let pageWidth="calc((100% - "+(this.pagesToShow+iteratorMod)*this.pageSpacing+this.pageSpacingUnits+") / "+this.pagesToShow+")";newPage.style.width=pageWidth,"slider"==this.type?a<=this.pagesToShow+2&&(newPos="calc((((100% - "+(this.pagesToShow+iteratorMod)*this.pageSpacing+this.pageSpacingUnits+") / "+this.pagesToShow+") * "+(a-1)+") + "+(this.pageSpacing*(a+iteratorMod2)+this.pageSpacingUnits)+")"):"gallery"==this.type&&(newPos=this.calcPagePos(a)),newPage.style.position="absolute",this.pages[a].backgroundImage&&"none"==this.lazyLoad||this.pages[a].backgroundImage&&"hidden"==this.lazyLoad&&(a<this.pagesToShow+this.scrollBy||a>=this.pages.length-this.scrollBy)?(newPage.style.backgroundImage="url("+this.pages[a].backgroundImage+")",this.pages[a].isLoaded=!0):"all"!=this.lazyLoad||this._handledLoad||(this._handledLoad=!0,window.addEventListener("load",()=>{this.load(this._orderedPages)})),this.pages[a].html&&(newPage.innerHTML=this.pages[a].html,this.pages[a].css&&(pagesCss+=this.pages[a].css)),"gallery"==this.type&&(newPage.style.transition=`opacity ${this.transition/1e3}s ${this.transitionFunction}`),document.querySelector(`.roundabout-${this._uniqueId}-page-wrap`).appendChild(newPage),this._orderedPages.push(a),"slider"==this.type?a<=this.pagesToShow+1?this._positions.push(newPos):this._positions.push("0px"):"gallery"==this.type&&(a<this.pagesToShow?this._positions.push(newPos):this._positions.push("0px")),a<this.pagesToShow&&document.querySelector(`.roundabout-${this._uniqueId}-page-${this._orderedPages[a]}`).classList.add(`roundabout-${this._uniqueId}-visible-page-${a}`)}"gallery"==this.type&&(document.querySelector(`.roundabout-${this._uniqueId}-page-wrap`).style.left=this.calcPagePos(0,{forceType:"slider"}));let newPagesStyle=document.createElement("STYLE");if(newPagesStyle.setAttribute("type","text/css"),newPagesStyle.innerHTML=pagesCss,document.getElementsByTagName("head")[0].appendChild(newPagesStyle),this.navigation&&this.uiEnabled){let navbar=document.createElement("div"),numButtons;navbar.classList.add(`roundabout-${this._uniqueId}-nav-wrap`,"roundabout-nav-wrap"),document.querySelector(`.roundabout-${this._uniqueId}-ui`).appendChild(navbar);let m=1;"slider"==this.type?numButtons=this.infinite||!this.navigationTrim?this.pages.length:this.pages.length-(this.pagesToShow-1):"gallery"==this.type&&(m=this.pagesToShow,numButtons=Math.floor(this.pages.length/this.pagesToShow));for(let a=0;a<numButtons;a++){let newNavBtn=document.createElement("div");0==a?newNavBtn.classList.add(`roundabout-${this._uniqueId}-active-nav-btn`,"roundabout-active-nav-btn"):newNavBtn.classList.add(`roundabout-${this._uniqueId}-inactive-nav-btn`,"roundabout-inactive-nav-btn"),newNavBtn.classList.add(`roundabout-${this._uniqueId}-nav-btn`,`roundabout-${this._uniqueId}-nav-btn-${a}`,"roundabout-nav-btn"),navbar.appendChild(newNavBtn),newNavBtn.addEventListener("click",()=>{this.scrollTo(a*m)})}}"slider"==this.type&&this._positions.push(this._positions.shift()),this.positionPages()}destroy(regen=!0,complete=!1){if(this._callbacks.beforeDestroy.forEach(cb=>{cb()}),clearTimeout(this._scrollTimeoutHolder),clearInterval(this._scrollIntervalHolder),clearTimeout(this._scrollAfterTimeoutHolder),complete)document.querySelector(this.id).remove();else if(document.querySelector(this.id).innerHTML="",regen){this._positions=[],this._orderedPages=[];try{this.initialActions(!0)&&this.setListeners(!0)}catch(e){console.error(`Error while attempting to regenerate Roundabout with id ${this.id}:`),console.error(e)}}this._callbacks.afterDestroy.forEach(cb=>{cb()})}setBreakpoints(){let lbp={width:-1};this.breakpoints.forEach(bp=>{bp.hasOwnProperty("width")||console.error("Breakpoint is missing a 'width' property, which defines the screen or window size to apply at."),(window.innerWidth<=bp.width||screen.width<=bp.width)&&(bp.width<=lbp.width||-1==lbp.width)&&(lbp=bp)}),this._currentBp!=lbp.width&&(this._currentBp=lbp.width,-1==lbp.width?this.activeBreakpoint={}:this.activeBreakpoint=lbp,this.applyBreakpoint(lbp))}applyBreakpoint(breakpoint){for(let a=0;a<this._overriddenValues.length;a++)this[this._overriddenValues[a][0]]=this._overriddenValues[a][1];this._overriddenValues=[];let t=Object.entries(this),p=Object.entries(breakpoint);for(let a=0;a<p.length;a++)for(let b=0;b<t.length;b++)p[a][0].toString()==t[b][0].toString()&&(this._overriddenValues.push([p[a][0].toString(),this[p[a][0]]]),this[p[a][0].toString()]=p[a][1]);this.destroy()}initialActions(r=!1){if(this._allowInternalStyles&&this.internalCSS(),this.checkForErrors(r)){r||roundabout.on++,this._allowInternalHTML&&this.defaultHTML(r),this.autoscroll&&this.setAutoScroll(this,r),this.uiEnabled||(this.navigation=!1,this.swipe=!1),"left"==this.rotation?this.rotation=-1:"right"==this.rotation&&(this.rotation=1),"gallery"==this.type&&(this.scrollBy=this.pagesToShow);try{this.generatePages()}catch(e){console.error(`Error while attempting to generate Roundabout with id ${this.id}:`),console.error(e)}return this.interpolate.forEach(i=>{i.between[0][0]>i.between[1][0]&&this.interpolate[this.interpolate.indexOf(i)].between.push(this.interpolate[this.interpolate.indexOf(i)].between.shift())}),this._boundFollow=this._execMM.bind(this),this._boundEnd=this._execMU.bind(this),this._boundCancel=this._execTC.bind(this),!0}return!1}setListeners(r=!1){this.uiEnabled&&this.buttons&&(document.querySelector(`.roundabout-${this._uniqueId}-btn-next`).addEventListener("click",()=>{this.scrollHandler(this,"listener",this.scrollBy)}),document.querySelector(`.roundabout-${this._uniqueId}-btn-prev`).addEventListener("click",()=>{this.scrollHandler(this,"listener",-this.scrollBy)})),this.keys&&!r&&document.addEventListener("keydown",event=>{this.keyListener(event)}),this.listenForResize&&!r&&setTimeout(()=>{window.addEventListener("resize",()=>{this.setBreakpoints()})},0),r||(this._calculatedPageSize=document.querySelector(`.roundabout-${this._uniqueId}-page-0`).offsetWidth,setTimeout(()=>{window.addEventListener("resize",()=>{this._calculatedPageSize=document.querySelector(`.roundabout-${this._uniqueId}-page-0`).offsetWidth})},0)),this.autoscrollPauseOnHover&&(document.querySelector(this.parent).addEventListener("mouseover",()=>{this._scrollIsAllowed=!1}),document.querySelector(this.parent).addEventListener("mouseout",()=>{this._scrollIsAllowed=!0,this.resetScrollTimeout(!0)})),this.swipe&&(document.querySelector(`.roundabout-${this._uniqueId}-swipe-overlay`).addEventListener("mousedown",event=>{this.tStart(event,this)},{capture:!1}),document.querySelector(`.roundabout-${this._uniqueId}-swipe-overlay`).addEventListener("touchstart",event=>{this.setTouch(event,this)},{capture:!1}))}keyListener(event){switch(event.key){case"ArrowLeft":this.scrollHandler(this,"key",-this.scrollBy);break;case"ArrowRight":this.scrollHandler(this,"key",this.scrollBy)}}checkForErrors(r){return this.pages.length<3?(this.displayError("The minimum number of pages supported is 3."),!1):this.pages.length-this.pagesToShow<=0?(this.displayError("Too many pages are being displayed at once. There must be at least 2 fewer pages shown than the number of total pages."),!1):(0!=this.pages.length&&this.pages.length||this.displayError("No pages have been supplied. Please create a 'pages' array containing your pages. See the documentation for details."),"#"!==this.id.split("")[0]&&"."!==this.id.split("")[0]?(this.displayError("An invalid selector prefix was given for the parent. Valid selector prefixes are '#' for IDs or '.' for classes."),!1):roundabout.usedIds.includes(this.id)&&!r?(this.displayError(`The selector '${this.id}' is already in use by another carousel. Please use a unique selector.`),!1):(roundabout.usedIds.push(this.id),this.pagesToShow<this.scrollBy?(this.displayError("'scrollBy' must be less than or equal to 'pagesToShow'."),!1):"gallery"!=this.type||!this.navigation||this.pages.length%this.pagesToShow==0||(this.displayError("To enable navigation on 'gallery' mode carousels, the total number of pages must be divisible by the number of pages shown. This prevents visible page inconsistencies after scrolling manually."),!1)))}load(pageIds=[],a=!1){if(pageIds.forEach(id=>{this._loadQueue.includes(id)||this._loadQueue.push(id)}),0!=this._loadQueue.length){if(this._loadingPages||(a=!0),a)if(this.pages[this._loadQueue[0]].isLoaded)this._loadQueue=this._loadQueue.splice(1,this._loadQueue.length-1),this.load(this._loadQueue,!0);else{this._loadingPages=!0;let bgImg=new Image;bgImg.onload=()=>{document.querySelector(`.roundabout-${this._uniqueId}-page-${this._loadQueue[0]}`).style.backgroundImage="url("+bgImg.src+")",document.querySelector(`.roundabout-${this._uniqueId}-page-${this._loadQueue[0]}`).style.backgroundSize="cover",document.querySelector(`.roundabout-${this._uniqueId}-page-${this._loadQueue[0]}`).style.backgroundPosition="center center",this.pages[this._loadQueue[0]].isLoaded=!0,this._callbacks.load.forEach(cb=>{cb.pageId==this._loadQueue[0]&&cb.callback(this._loadQueue[0])}),this._loadQueue=this._loadQueue.splice(1,this._loadQueue.length-1),this.load(this._loadQueue,!0)},bgImg.src=this.pages[this._loadQueue[0]].backgroundImage}}else this._loadingPages=!1}positionPages(pre=!1){for(let a=0;a<this._positions.length;a++)"0px"==this._positions[a]?(document.querySelector(`.roundabout-${this._uniqueId}-page-${a}`).classList.add(`roundabout-${this._uniqueId}-hidden-page`),document.querySelector(`.roundabout-${this._uniqueId}-page-${a}`).style.left=this._positions[a]):(document.querySelector(`.roundabout-${this._uniqueId}-page-${a}`).style.left=this._positions[a],document.querySelector(`.roundabout-${this._uniqueId}-page-${a}`).classList.remove(`roundabout-${this._uniqueId}-hidden-page`),!this.infinite&&0==a&&this._onPage>1&&!this.showWrappedPage&&document.querySelector(`.roundabout-${this._uniqueId}-page-${a}`).classList.add(`roundabout-${this._uniqueId}-hidden-page`),this.infinite||a!=this._positions.length-1||0!=this._onPage||this.showWrappedPage||document.querySelector(`.roundabout-${this._uniqueId}-page-${this._positions.length-1}`).classList.add(`roundabout-${this._uniqueId}-hidden-page`))}positionWrap(setTransitions=!0,position=0){let wrapper=document.querySelector(`.roundabout-${this._uniqueId}-page-wrap`);setTransitions&&(wrapper.classList.remove(`roundabout-${this._uniqueId}-has-transition`),wrapper.classList.add("roundabout-has-no-transition")),wrapper.style.left=this.calcPagePos(position,{wrap:!0});const flushCssBuffer=wrapper.offsetWidth;setTransitions&&(wrapper.classList.add(`roundabout-${this._uniqueId}-has-transition`),wrapper.classList.remove("roundabout-has-no-transition"))}findOffset(start,end,direction){return"p"==direction?end<start?start-end:start+this.pages.length-end:"n"==direction?end<start?this.pages.length-start+end:end-start:void 0}calcPagePos(pagePos,options={wrap:!1,forceType:this.type,direction:null}){if(null==options.forceType&&(options.forceType=this.type),0==pagePos&&"slider"==options.forceType&&("fill"==this.pageSpacingMode||options.wrap))return"0px";if("gallery"==options.forceType){if(options.direction>0&&pagePos>=2*this.pagesToShow)return"0px";if(options.direction<0&&(pagePos<-this.pagesToShow||pagePos>=this.pagesToShow))return"0px"}"slider"==options.forceType&&(pagePos+=1);let spacesAdjust,spacesAdjust2,adjust=0,newPos;return"evenly"==this.pageSpacingMode?(spacesAdjust=1,spacesAdjust2=0,options.wrap&&(adjust=-this.pageSpacing)):(spacesAdjust=-1,spacesAdjust2="slider"==options.forceType?-1:0),"slider"==options.forceType?newPos="calc((((100% - "+(this.pagesToShow+spacesAdjust)*this.pageSpacing+this.pageSpacingUnits+") / "+this.pagesToShow+") * "+(pagePos-1)+") + "+(this.pageSpacing*(pagePos+spacesAdjust2)+adjust+this.pageSpacingUnits)+")":"gallery"==options.forceType&&(newPos="calc((((100% - "+(this.pagesToShow+spacesAdjust)*this.pageSpacing+this.pageSpacingUnits+") / "+this.pagesToShow+") * "+pagePos%this.pagesToShow+") + "+(this.pageSpacing*(pagePos%this.pagesToShow+spacesAdjust2)+adjust+this.pageSpacingUnits)+")"),newPos}subscribe(event,newCallback){this._callbacks[event].push(newCallback)}displayError(message,title="Error:"){let em=document.createElement("DIV");em.classList.add("roundabout-error-message");let t=document.createElement("SPAN");t.innerHTML=title,t.style.color="red",t.style.fontWeight="bold",em.appendChild(t);let m=document.createElement("SPAN");m.innerHTML=message;let lb=document.createElement("BR");em.appendChild(lb),em.appendChild(m),document.querySelector(this.parent).appendChild(em),console.error(message)}}